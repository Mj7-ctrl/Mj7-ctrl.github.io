import random
from flask import Flask, jsonify

class Satellite:
    def __init__(self):
        self.position = self.get_random_position()

    def get_random_position(self):
        lat = random.uniform(-90, 90)
        lon = random.uniform(-180, 180)
        return (lat, lon)

    def get_position(self):
        return self.position

class Scanner:
    def __init__(self, range_km):
        self.range_km = range_km

    def scan_for_enemies(self, satellite_position):
        enemies_detected = random.randint(0, 5)
        enemy_positions = []

        for _ in range(enemies_detected):
            enemy_lat = satellite_position[0] + random.uniform(-self.range_km / 111, self.range_km / 111)
            enemy_lon = satellite_position[1] + random.uniform(-self.range_km / 111, self.range_km / 111)
            enemy_positions.append((enemy_lat, enemy_lon))

        return enemy_positions

app = Flask(__name__)

satellite = Satellite()
scanner = Scanner(range_km=50)

@app.route('/scan', methods=['GET'])
def scan():
    satellite_position = satellite.get_position()
    enemies = scanner.scan_for_enemies(satellite_position)
    response = {
        "satellite_position": satellite_position,
        "enemies_detected": enemies
    }
    return jsonify(response)

if __name__ == '__main__':
    app.run(debug=True)
